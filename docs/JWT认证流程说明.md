# JWT认证流程说明

## 概述

本文档描述了体育赛事管理系统中JWT（JSON Web Token）认证的完整流程，包括用户登录、令牌生成、令牌验证以及刷新机制等关键环节。

## JWT认证时序图

```mermaid
sequenceDiagram
    participant 用户
    participant 前端应用
    participant 认证服务
    participant 资源服务
    participant 数据库

    用户->>前端应用: 输入用户名和密码
    前端应用->>认证服务: 发送登录请求
    认证服务->>数据库: 验证用户凭证
    数据库-->>认证服务: 返回用户信息
    
    alt 验证成功
        认证服务->>认证服务: 生成JWT令牌(包含用户ID、角色等)
        认证服务-->>前端应用: 返回JWT令牌和刷新令牌
        前端应用->>前端应用: 存储JWT令牌(localStorage)
    else 验证失败
        认证服务-->>前端应用: 返回认证失败信息
    end
    
    用户->>前端应用: 请求受保护资源
    前端应用->>资源服务: 请求资源(携带JWT令牌)
    资源服务->>资源服务: 验证JWT令牌签名和有效期
    
    alt 令牌有效
        资源服务->>数据库: 获取请求的资源数据
        数据库-->>资源服务: 返回资源数据
        资源服务-->>前端应用: 返回请求的资源
        前端应用-->>用户: 展示资源
    else 令牌过期
        资源服务-->>前端应用: 返回令牌过期错误
        前端应用->>认证服务: 使用刷新令牌请求新的JWT
        认证服务->>认证服务: 验证刷新令牌
        认证服务-->>前端应用: 返回新的JWT令牌
        前端应用->>资源服务: 使用新令牌重新请求资源
    else 令牌无效
        资源服务-->>前端应用: 返回认证失败错误
        前端应用-->>用户: 提示重新登录
    end